<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>çŸ­è§†é¢‘åˆ†é•œè„šæœ¬ç”Ÿæˆå™¨ - Matrix Tools</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#6C5CE7',
              secondary: '#00D2D3',
              dark: '#191924',
              light: '#F8F9FA',
              accent: '#FD79A8',
              surface: '#20202d'
            },
            fontFamily: {
              sans: ['Inter', 'system-ui', 'sans-serif'],
              display: ['Montserrat', 'sans-serif']
            },
            animation: {
              'float': 'float 6s ease-in-out infinite',
              'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            },
            keyframes: {
              float: {
                '0%, 100%': { transform: 'translateY(0)' },
                '50%': { transform: 'translateY(-20px)' },
              },
              'pulse-glow': {
                '0%, 100%': { opacity: 1, boxShadow: '0 0 15px rgba(108,92,231,0.5)' },
                '50%': { opacity: .8, boxShadow: '0 0 25px rgba(108,92,231,0.8)' },
              }
            }
          },
        },
      }
    </script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
      body { background-color: #191924; color: #F8F9FA; }
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-track { background: #191924; }
      ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #444; }
      .glass-panel {
        background: rgba(32, 32, 45, 0.6);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      /* Table Styles */
      .script-table td, .script-table th {
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 12px;
        text-align: left;
        vertical-align: top;
      }
      .script-table th {
        background-color: rgba(108, 92, 231, 0.1);
        font-weight: 600;
        color: #00D2D3;
        font-family: 'Montserrat', sans-serif;
        font-size: 0.85rem;
        letter-spacing: 0.05em;
        text-transform: uppercase;
      }
      .script-table td[contenteditable="true"]:focus {
        background-color: rgba(255, 255, 255, 0.05);
        outline: 1px solid #6C5CE7;
      }
      .ad-placeholder {
        background-image: repeating-linear-gradient(45deg, #2a2a35 0, #2a2a35 10px, #25252e 10px, #25252e 20px);
      }
    </style>
</head>
<body class="font-sans overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // --- ICONS ---
      const LogoIcon = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" className={className} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 2L2 7L12 12L22 7L12 2Z"/><path d="M2 17L12 22L22 17"/><path d="M2 12L12 17L22 12"/></svg>
      );
      const VideoIcon = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" className={className} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
      );
      const LightningIcon = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" className={className} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" /></svg>
      );
      const DownloadIcon = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" className={className} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
      );

      const Navbar = () => (
        <nav className="w-full h-20 px-6 md:px-12 flex items-center justify-between sticky top-0 z-50 transition-all duration-300 backdrop-blur-md bg-dark/80 border-b border-white/5">
          <a href="index.html" className="text-2xl font-display font-bold text-white flex items-center gap-3 decoration-0 group">
            <span className="w-10 h-10 bg-primary rounded-xl flex items-center justify-center shadow-lg shadow-primary/30 group-hover:scale-105 transition-transform">
              <LogoIcon className="w-6 h-6 text-white" />
            </span>
            <span>Matrix<span className="text-primary">Tools</span></span>
          </a>
          <div className="hidden md:flex items-center space-x-8">
            <a href="index.html" className="text-white hover:text-primary transition-colors font-medium flex items-center gap-2">
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
              è¿”å›é¦–é¡µ
            </a>
          </div>
        </nav>
      );

      // --- COMMERCIAL COMPONENTS ---
      const AdUnit = ({ label }) => (
        <div className="w-full h-[90px] ad-placeholder rounded-lg border border-white/5 flex flex-col items-center justify-center text-gray-600 my-6">
           <span className="text-xs font-mono uppercase tracking-widest opacity-50">Advertisement</span>
           <span className="font-semibold">{label}</span>
        </div>
      );

      const AffiliateCard = ({ title, desc, tag, href }) => (
        <a href={href || "#"} onClick={(e) => { if (!href) e.preventDefault(); }} className="block bg-[#1e1e26] border border-white/5 hover:border-secondary/30 rounded-xl p-4 transition-all hover:translate-x-1 group">
           <div className="flex justify-between items-start mb-2">
              <h4 className="font-bold text-white group-hover:text-secondary">{title}</h4>
              {tag && <span className="text-[10px] bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded uppercase">{tag}</span>}
           </div>
           <p className="text-xs text-gray-500">{desc}</p>
        </a>
      );

      const CommercialSidebar = () => (
        <div className="space-y-6 sticky top-24">
           <div className="glass-panel rounded-2xl p-5 border-l-2 border-secondary">
              <h3 className="text-lg font-display font-bold text-white mb-4 flex items-center gap-2">
                <span>ğŸ’° ç”µå•†äººæé’±ç¥å™¨</span>
              </h3>
              
              <div className="space-y-3">
                 <AffiliateCard 
                   title="åº—ç¾¤å¿…å¤‡é˜²å…³è”å°å·" 
                   desc="é¢†76å…ƒæ— é—¨æ§›åˆ¸" 
                   tag="æ¨è"
                   href="https://www.ziniao.com/sharelinks/?from=17659016511852&activity_id=114"
                 />
                 <AffiliateCard 
                   title="æ— è´§æº ERP" 
                   desc="è‡ªåŠ¨é‡‡é›†/å‘è´§ï¼Œè§£æ”¾åŒæ‰‹" 
                 />
                 <AffiliateCard 
                   title="1688 ä»¥å›¾æœå›¾" 
                   desc="å¿«é€Ÿæ‰¾åŒæ¬¾ï¼Œåˆ©æ¶¦ç¿»å€" 
                   tag="é»‘ç§‘æŠ€"
                 />
              </div>
              
              <div className="mt-6 pt-4 border-t border-white/5 text-center">
                 <p className="text-xs text-gray-500 mb-2">å¹¿å‘Šåˆä½œè”ç³»</p>
                 <button className="text-secondary text-sm font-semibold hover:underline">Support@MatrixTools</button>
              </div>
           </div>

           <div className="w-full h-[250px] ad-placeholder rounded-lg border border-white/5 flex flex-col items-center justify-center text-gray-600">
              <span className="text-xs font-mono uppercase tracking-widest opacity-50">Ad Space</span>
              <span className="font-semibold text-center px-4">Square Ad (250x250)</span>
           </div>
        </div>
      );

      const ScriptGenerator = () => {
        const [inputs, setInputs] = useState({
          productName: '',
          painPoint: '',
          price: '',
          mode: 'fear'
        });
        const [scriptRows, setScriptRows] = useState([]);
        const tableRef = useRef(null);

        const handleInputChange = (e) => {
          setInputs({ ...inputs, [e.target.name]: e.target.value });
        };

        const generateScript = () => {
          if (!inputs.productName) {
            alert("è¯·è¾“å…¥äº§å“åç§°");
            return;
          }

          const { productName, painPoint, price } = inputs;
          let newRows = [];

          if (inputs.mode === 'fear') {
            newRows = [
              { time: "01 (0-3s)", camera: "ç‰¹å†™/æ¨é•œå¤´", visual: `[é»‘ç™½æ»¤é•œ] å±•ç¤º${painPoint || 'è„ä¹±å·®'}çš„æç«¯åœºæ™¯ï¼Œçªå‡ºä»¤äººå´©æºƒçš„ç¬é—´ã€‚`, dialogue: `åˆ«å†äº¤æ™ºå•†ç¨äº†ï¼è¿™ç§${painPoint || 'æ±¡æ¸'}åƒä¸‡åˆ«ç¡¬æ“¦ï¼`, text: "åœæ‰‹ï¼âŒ", sfx: "è­¦æŠ¥å£° + ç»ç’ƒç¢è£‚å£°" },
              { time: "02 (3-8s)", camera: "ä¸­æ™¯/æ‰‹æŒ", visual: `[æ¢å¤å½©è‰²] ä¸»æ’­æ„¤æ€’åœ°å°†å…¶ä»–åŠ£è´¨äº§å“æ‰«å¼€ï¼Œæ‹¿å‡º${productName}ï¼Œç‹ ç‹ ç ¸åœ¨æ¡Œä¸Šã€‚`, dialogue: `è¯•è¯•è¿™ä¸ª${productName}ï¼Œæˆ‘å®¶ä¿æ´é˜¿å§¨éƒ½åœ¨å·å·ç”¨...`, text: `${productName}`, sfx: "é‡éŸ³å’šï¼" },
              { time: "03 (8-15s)", camera: "ç‰¹å†™/åŠ é€Ÿ", visual: `[å®æ“æ¼”ç¤º] å°†${productName}å–·/æ¶‚åœ¨${painPoint || 'æ±¡æ¸'}å¤„ï¼Œé™ç½®3ç§’ï¼Œä¸€æ“¦å³å‡€ã€‚å·¦å³å¯¹æ¯”ã€‚`, dialogue: `ä½ çœ‹ï¼Œåªè¦è½»è½»å–·ä¸€ä¸‹ï¼Œç­‰ä¸ª3ç§’é’Ÿï¼Œä¸€æ“¦å°±å¹²å‡€äº†ï¼Œè·Ÿæ–°çš„ä¸€æ ·ï¼`, text: "ä¸€æ“¦å³å‡€ âœ¨", sfx: "é­”æ³•éŸ³æ•ˆ (Ding!)" },
              { time: "04 (15-20s)", camera: "ä¸­æ™¯/å›ºå®š", visual: `ä¸»æ’­æ‰‹æŒäº§å“ï¼ŒèƒŒæ™¯å±•ç¤ºå¹²å‡€æ•´æ´çš„æ•ˆæœã€‚å±•ç¤ºæƒå¨æ£€æµ‹æŠ¥å‘Šæˆ–å¥½è¯„æˆªå›¾ã€‚`, dialogue: `è¶…å¸‚é‡Œä¸€ç“¶è¦å‡ åå—ï¼Œä»Šå¤©æºå¤´å‚å®¶ç›´å‘ï¼Œæ²¡æœ‰ä¸­é—´å•†èµšå·®ä»·ã€‚`, text: "æºå¤´ç›´å‘ ğŸ­", sfx: "æ”¶é“¶æœºå£° (Cha-ching)" },
              { time: "05 (20-25s)", camera: "ç‰¹å†™/æ¨é•œå¤´", visual: `[é€¼å•] å±•ç¤º${price}å…ƒåˆ°æ‰‹æ•°é‡ï¼Œå€’è®¡æ—¶ç‰¹æ•ˆã€‚`, dialogue: `ä»Šå¤©ä¸‹å•ï¼Œ${price}ç›´æ¥å¸¦èµ°${inputs.price.includes('ç“¶') ? '' : 'ä¸€å¥—'}ï¼ä»…é™å‰100åï¼Œæ‰‹æ…¢æ— ï¼`, text: `é™æ—¶: ${price}`, sfx: "å€’è®¡æ—¶æ»´ç­”å£°" }
            ];
          } else if (inputs.mode === 'visual') {
            newRows = [
              { time: "01 (0-5s)", camera: "ç‰¹å†™/å¾®è·", visual: `[æé™æµ‹è¯•] ç”¨é…±æ²¹/æœºæ²¹/å¢¨æ°´ç–¯ç‹‚æ³¼æ´’åœ¨ç™½è‰²ç‰©ä½“ä¸Šï¼Œè§†è§‰å†²å‡»åŠ›æå¼ºã€‚`, dialogue: `å¦‚æœä½ çš„ä¸œè¥¿è„æˆè¿™æ ·ï¼Œåƒä¸‡åˆ«æ‰”ï¼æ‰”äº†å°±æ˜¯æ‰”é’±ï¼`, text: "åˆ«æ‰”ï¼ğŸ˜±", sfx: "æ³¼æ°´å£° + æƒŠå‘¼å£°" },
              { time: "02 (5-10s)", camera: "ç‰¹å†™", visual: `ç›´æ¥ä½¿ç”¨${productName}è¦†ç›–æ±¡æ¸ï¼Œä¸å‰ªè¾‘ï¼Œä¸€é•œåˆ°åº•å±•ç¤ºæº¶è§£è¿‡ç¨‹ã€‚`, dialogue: `ä»Šå¤©å°±ç”¨è¿™ä¸ª${productName}æŒ‘æˆ˜å…¨ç½‘æœ€éš¾æ¸…æ´çš„æ±¡å¢ã€‚çœ‹å¥½äº†ï¼Œåƒä¸‡åˆ«çœ¨çœ¼ï¼`, text: "æé™æŒ‘æˆ˜ ğŸ”¥", sfx: "å¿ƒè·³å£°" },
              { time: "03 (10-18s)", camera: "ä¸­æ™¯", visual: `å±•ç¤ºæ¸…æ´åçš„å®Œç¾æ•ˆæœï¼Œä¸æ¸…æ´å‰å½¢æˆæå…¶å¼ºçƒˆçš„å¯¹æ¯”ã€‚`, dialogue: `å“‡ï¼çœ‹åˆ°äº†å—ï¼Ÿè¿™å°±å«ä¸“ä¸šï¼çœæ—¶çœåŠ›åˆçœå¿ƒã€‚`, text: "å®Œå¥½å¦‚åˆ âœ…", sfx: "æ¬¢å‘¼å£°" },
              { time: "04 (18-22s)", camera: "ç‰¹å†™", visual: `å±•ç¤ºäº§å“ç»†èŠ‚ï¼Œæˆåˆ†è¡¨ï¼Œå¼ºè°ƒå®‰å…¨æ— å®³ã€‚`, dialogue: `ä¸ä¼¤æ‰‹ä¸ä¼¤æè´¨ï¼Œå®¶é‡Œæœ‰å­•å¦‡å°å­©éƒ½èƒ½æ”¾å¿ƒç”¨ã€‚`, text: "å®‰å…¨æ— æ¯’ ğŸ›¡ï¸", sfx: "è½»æŸ”BGM" },
              { time: "05 (22-25s)", camera: "ä¸­æ™¯/æ¨é•œå¤´", visual: `ä¸»æ’­æŠ±èµ·ä¸€å †èµ å“/äº§å“ï¼Œå¼ºè°ƒä»Šå¤©çš„æœºåˆ¶ã€‚`, dialogue: `ä¸ºäº†åšå£ç¢‘ï¼Œä»Šå¤©${price}ç»™åˆ°å¤§å®¶ã€‚ç‚¹ä¸‹æ–¹å°é»„è½¦ï¼Œæ‹¼æ‰‹é€Ÿäº†ï¼`, text: `æŠ¢: ${price}`, sfx: "ç§’æ€éŸ³æ•ˆ" }
            ];
          } else if (inputs.mode === 'factory') {
            newRows = [
              { time: "01 (0-5s)", camera: "å¹¿è§’/æ— äººæœº", visual: `å·¥å‚æµæ°´çº¿å®æ‹ï¼Œæœºå™¨è½°é¸£ï¼Œæˆåƒä¸Šä¸‡çš„è´§ç‰©å †ç§¯ã€‚`, dialogue: `å®ä½“åº—å‡ ç™¾å—çš„ä¸œè¥¿ï¼Œå‡ºå‚ä»·å…¶å®åªè¦å‡ å—é’±ï¼ä»Šå¤©å¸¦å¤§å®¶æ­ç§˜è¡Œä¸šå†…å¹•ã€‚`, text: "è¡Œä¸šå†…å¹• ğŸ¤«", sfx: "å·¥å‚æœºå™¨å£°" },
              { time: "02 (5-10s)", camera: "è·Ÿæ‹", visual: `è€æ¿/å‚é•¿å¸¦ç€é•œå¤´èµ°è¿›ä»“åº“ï¼Œéšæ‰‹æ‹¿èµ·ä¸€ä¸ª${productName}ã€‚`, dialogue: `æˆ‘ä»¬æ˜¯${productName}çš„æºå¤´å·¥å‚ï¼Œç»™å¤§ç‰Œä»£å·¥åå‡ å¹´äº†ã€‚`, text: "æºå¤´å·¥å‚ ğŸ­", sfx: "è„šæ­¥å£°" },
              { time: "03 (10-15s)", camera: "ç‰¹å†™", visual: `æš´åŠ›æ‹†è§£äº§å“æˆ–å±•ç¤ºæ ¸å¿ƒåŸæ–™ï¼Œè¯æ˜å“è´¨ã€‚`, dialogue: `ç”¨æ–™è·Ÿå¤§ç‰Œä¸€æ¨¡ä¸€æ ·ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰å“ç‰Œæº¢ä»·ï¼Œæ²¡æœ‰æ˜‚è´µçš„å¹¿å‘Šè´¹ã€‚`, text: "æ‹’ç»æš´åˆ© ğŸ’°", sfx: "æ’•è£‚å£°/æ•²å‡»å£°" },
              { time: "04 (15-20s)", camera: "ä¸­æ™¯", visual: `å±•ç¤ºä»Šæ—¥ç‰¹ä»·æœºåˆ¶ï¼Œ${price}çš„å­—æ ·æ‰“åœ¨å…¬å±ä¸Šã€‚`, dialogue: `è€æ¿è¯´äº†ï¼Œä»Šå¤©ä¸ºäº†æ¸…åº“å­˜ï¼Œ${price}ç›´æ¥åŒ…é‚®åˆ°å®¶ï¼Œè¿˜æ˜¯ç ´æŸåŒ…èµ”ã€‚`, text: "ç ´æŸåŒ…èµ” ğŸ“¦", sfx: "ç›–ç« å£°" },
              { time: "05 (20-25s)", camera: "ç‰¹å†™", visual: `ç‚¹å‡»æ‰‹æœºå±å¹•çš„åŠ¨ä½œå¼•å¯¼ã€‚`, dialogue: `æƒ³è¦çš„å®¶äººï¼Œç›´æ¥ç‚¹å·¦ä¸‹è§’ï¼ŒæŠ¢åˆ°å°±æ˜¯èµšåˆ°ï¼`, text: "ç‚¹å‡»è´­ä¹° ğŸ‘‡", sfx: "ç‚¹å‡»å£°" }
            ];
          }

          setScriptRows(newRows);
        };

        const exportToExcel = () => {
          if (!tableRef.current || scriptRows.length === 0) {
            alert("è¯·å…ˆç”Ÿæˆè„šæœ¬å†…å®¹");
            return;
          }
          
          const wb = XLSX.utils.book_new();
          const ws = XLSX.utils.table_to_sheet(tableRef.current);
          
          // Adjust column widths visually
          ws['!cols'] = [
            { wch: 15 }, // Time
            { wch: 20 }, // Camera
            { wch: 40 }, // Visual
            { wch: 40 }, // Dialogue
            { wch: 15 }, // Text
            { wch: 20 }  // SFX
          ];

          XLSX.utils.book_append_sheet(wb, ws, "æ‹æ‘„è„šæœ¬");
          const fileName = inputs.productName ? `${inputs.productName}_æ‹æ‘„è„šæœ¬.xlsx` : "çŸ­è§†é¢‘åˆ†é•œè„šæœ¬.xlsx";
          XLSX.writeFile(wb, fileName);
        };

        return (
          <section className="w-full max-w-7xl mx-auto px-4 md:px-6 py-8 pb-32">
             <AdUnit label="Google AdSense å¹¿å‘Šä½ (Top Banner)" />

             <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
               {/* Left: Tool Area (3 Cols) */}
               <div className="lg:col-span-3 space-y-8">
                 {/* Header */}
                 <div className="flex flex-col md:flex-row md:items-end justify-between gap-4">
                   <div>
                     <h1 className="text-3xl md:text-4xl font-display font-bold text-white mb-2 flex items-center gap-3">
                       <VideoIcon className="w-8 h-8 text-primary" />
                       åˆ†é•œè„šæœ¬ç”Ÿæˆå™¨ <span className="text-sm font-normal text-primary border border-primary/30 px-2 py-0.5 rounded ml-2">Director's Cut</span>
                     </h1>
                     <p className="text-gray-400">è¾“å…¥æ ¸å¿ƒå‚æ•°ï¼Œä¸€é”®ç”Ÿæˆæ ‡å‡†åŒ–æ‹æ‘„é€šå‘Šå• (Call Sheet)</p>
                   </div>
                   
                   <button 
                      onClick={exportToExcel}
                      className="bg-dark border border-white/20 hover:border-secondary/50 text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all hover:bg-white/5 active:scale-95"
                   >
                      <DownloadIcon className="w-5 h-5 text-secondary" />
                      <span>å¯¼å‡º Excel æ‹æ‘„å•</span>
                   </button>
                 </div>

                 {/* Director Console */}
                 <div className="glass-panel p-6 rounded-2xl relative overflow-hidden">
                   <div className="absolute top-0 right-0 w-64 h-64 bg-primary/10 rounded-full blur-3xl -z-10 pointer-events-none"></div>
                   
                   <div className="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
                      <div className="space-y-2">
                        <label className="text-sm font-semibold text-gray-400">äº§å“åç§°</label>
                        <input 
                          type="text" 
                          name="productName"
                          value={inputs.productName}
                          onChange={handleInputChange}
                          placeholder="å¦‚: å¼ºåŠ›å»æ²¹ç‹" 
                          className="w-full bg-dark/50 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none transition-colors"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm font-semibold text-gray-400">æ ¸å¿ƒç—›ç‚¹</label>
                        <input 
                          type="text" 
                          name="painPoint"
                          value={inputs.painPoint}
                          onChange={handleInputChange}
                          placeholder="å¦‚: é™ˆå¹´æ²¹å¢æ“¦ä¸æ‰" 
                          className="w-full bg-dark/50 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none transition-colors"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm font-semibold text-gray-400">ä»·æ ¼/æœºåˆ¶</label>
                        <input 
                          type="text" 
                          name="price"
                          value={inputs.price}
                          onChange={handleInputChange}
                          placeholder="å¦‚: 9.9å…ƒä¸‰ç“¶" 
                          className="w-full bg-dark/50 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none transition-colors"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm font-semibold text-gray-400">è„šæœ¬æ¨¡å¼</label>
                        <div className="relative">
                          <select 
                            name="mode"
                            value={inputs.mode}
                            onChange={handleInputChange}
                            className="w-full bg-dark/50 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-primary outline-none appearance-none cursor-pointer"
                          >
                            <option value="fear">ğŸ‘¿ é»„é‡‘3ç§’æå“æµ</option>
                            <option value="visual">ğŸ§ª æš´åŠ›æµ‹è¯•è§†è§‰æµ</option>
                            <option value="factory">ğŸ­ æºå¤´å·¥å‚æ­ç§˜æµ</option>
                          </select>
                          <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400">
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" /></svg>
                          </div>
                        </div>
                      </div>
                   </div>

                   <div className="mt-8 flex justify-end">
                     <button 
                       onClick={generateScript}
                       className="w-full md:w-auto bg-gradient-to-r from-primary to-purple-600 text-white font-bold py-4 px-12 rounded-xl flex items-center justify-center gap-2 animate-pulse-glow transition-transform active:scale-95"
                     >
                       <LightningIcon className="w-5 h-5" />
                       ä¸€é”®ç”Ÿæˆåˆ†é•œè„šæœ¬
                     </button>
                   </div>
                 </div>

                 {/* Script Table */}
                 <div className="relative overflow-x-auto rounded-2xl border border-white/10 shadow-2xl">
                   <table className="w-full script-table bg-[#1e1e26] text-sm md:text-base" id="script-table" ref={tableRef}>
                     <thead>
                       <tr>
                         <th className="w-24">é•œå·/æ—¶é•¿</th>
                         <th className="w-32">æ™¯åˆ«/è¿é•œ</th>
                         <th>ç”»é¢å†…å®¹ (Visual)</th>
                         <th>å°è¯/å£æ’­ (Dialogue)</th>
                         <th className="w-32">å­—å¹•/èŠ±å­—</th>
                         <th className="w-32">éŸ³æ•ˆ/BGM</th>
                       </tr>
                     </thead>
                     <tbody className="text-gray-300">
                       {scriptRows.length > 0 ? (
                         scriptRows.map((row, index) => (
                           <tr key={index} className="hover:bg-white/5 transition-colors">
                             <td contentEditable suppressContentEditableWarning>{row.time}</td>
                             <td contentEditable suppressContentEditableWarning className="text-secondary">{row.camera}</td>
                             <td contentEditable suppressContentEditableWarning>{row.visual}</td>
                             <td contentEditable suppressContentEditableWarning className="text-white italic">"{row.dialogue}"</td>
                             <td contentEditable suppressContentEditableWarning className="text-accent font-bold">{row.text}</td>
                             <td contentEditable suppressContentEditableWarning className="text-gray-400 text-xs">{row.sfx}</td>
                           </tr>
                         ))
                       ) : (
                         <tr>
                           <td colSpan="6" className="text-center py-12 text-gray-500">
                             <div className="flex flex-col items-center gap-3">
                               <div className="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center">
                                 <VideoIcon className="w-8 h-8 opacity-20" />
                               </div>
                               <p>æš‚æ— è„šæœ¬å†…å®¹ï¼Œè¯·åœ¨ä¸Šæ–¹è¾“å…¥å‚æ•°å¹¶ç‚¹å‡»ç”Ÿæˆ</p>
                             </div>
                           </td>
                         </tr>
                       )}
                     </tbody>
                   </table>
                 </div>
                 
                 <div className="mt-4 text-center text-xs text-gray-500">
                   * æç¤ºï¼šè¡¨æ ¼å†…å®¹å¯ç›´æ¥ç‚¹å‡»ä¿®æ”¹ï¼Œä¿®æ”¹åç‚¹å‡»â€œå¯¼å‡ºâ€å³å¯ä¿å­˜ä¸º Excel æ–‡ä»¶ã€‚
                 </div>
               </div>

               {/* Right: Sidebar (1 Col) */}
               <div className="lg:col-span-1">
                 <CommercialSidebar />
               </div>
             </div>

             <AdUnit label="Google AdSense å¹¿å‘Šä½ (Bottom Banner)" />
          </section>
        );
      };
      
      const Footer = () => (
        <footer className="w-full py-8 border-t border-white/5 bg-[#14141d] text-center mt-auto">
          <p className="text-gray-500 text-sm">Â© {new Date().getFullYear()} Matrix Tools é’±é’±ç”µå•†é»‘ç›’. All rights reserved.</p>
        </footer>
      );

      const App = () => (
        <div className="min-h-screen bg-dark text-white relative flex flex-col">
          <Navbar />
          <main className="flex-grow">
            <ScriptGenerator />
          </main>
          <Footer />
        </div>
      );

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
</body>
</html>